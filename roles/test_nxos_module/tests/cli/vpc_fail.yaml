---
- debug: msg="START cli/vpc_fail.yaml"

- name: ensure it fails due to missing param
  nxos_vpc:
    domain=10
    role_priority=1000
    system_priority=2000
    pkl_dest=192.168.100.2
    peer_gw=true
    auto_recovery=true
    host={{ inventory_hostname }}
    state=present
    transport=cli
    username=admin
    password=!cisco123!
  register: data
  ignore_errors: true

- assert:
    that:
      - data | failed
